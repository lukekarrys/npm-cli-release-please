{{> release }}

  release-comment:
    name: Release Comment
    runs-on: ubuntu-latest
    needs: [ release ]
    if: needs.release.outputs.release
    steps:
      - name: Pull Request Release Comment
        uses: actions/github-script@v6
        env:
          PR_NUMBER: $\{{ fromJSON(needs.release.outputs.release).prNumber }}
        with:
          script: |
            const { PR_NUMBER: issue_number } = process.env
            const { runId, repo: { owner, repo } } = context.runId
            let body = `Link to workflow run for this release: `
            body += `https://github.com/${repo.owner}/${repo.repo}/actions/runs/${runId}`    
            await github.rest.issues.createComment({ owner, repo, issue_number, body })

  release-integration:
    name: Nodejs Integration - Release
    needs: [ release ]
    if: needs.release.outputs.release
    uses: ./.github/workflows/release-integration.yml
    with:
      npmVersion: $\{{ fromJSON(needs.release.outputs.release).version }}